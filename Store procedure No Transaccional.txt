DELIMITER $$
CREATE PROCEDURE PA_INSERTAR_NO_TRANSACCIONAL (PIDCUENTAORIGEN INT, PIDCUENTADESTINO INT,  PVALOR NUMERIC(10,2))
BEGIN
SELECT "Error";
BEGIN
START TRANSACTION;
insert into TRANSFERENCIA values(PIDCUENTAORIGEN,PIDCUENTADESTINO,PVALOR);
insert into MOVIMIENTO(IDCUENTA,TIPOMOVIMIENTO,VALOR) values(PIDCUENTADESTINO,'A',PVALOR);
update CUENTA set SALDO=saldo+PVALOR where IDCUENTA=PIDCUENTADESTINO;
insert into MOVIMIENTO(IDCUENTA,TIPOMOVIMIENTO,VALOR) values(PIDCUENTAORIGEN,'D',PVALOR);
update CUENTA set SALDO=saldo-PVALOR where IDCUENTA=PIDCUENTAORIGEN;
COMMIT;
END ;
END;
$$
DELIMITER ;

CALL PA_INSERTAR_NO_TRANSACCIONAL (2, 1, 300);
select * from cuenta